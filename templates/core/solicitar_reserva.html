<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Reservar Campo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <h1>Reservar o Campo: {{ campo.nome_clube }}</h1>
        <p><strong>Endereço:</strong> {{ campo.endereco }}</p>
        <p><strong>Preço por Hora:</strong> R$ <span id="preco-hora">{{ campo.preco_por_hora }}</span></p>

        <form method="POST" class="card p-3">
            {% csrf_token %}
            <div class="mb-3">
                <label for="dia" class="form-label">Dia da Reserva:</label>
                <input type="date" id="dia" name="dia" class="form-control" required>
            </div>
            <div class="mb-3">
                <label for="horario_inicio" class="form-label">Horário de Início:</label>
                <input type="time" id="horario_inicio" name="horario_inicio" class="form-control" required>
            </div>
            <div class="mb-3">
                <label for="horario_termino" class="form-label">Horário de Término:</label>
                <input type="time" id="horario_termino" name="horario_termino" class="form-control" required>
            </div>

            <h3 class="mt-3">Valor Total: R$ <span id="valor-total">0.00</span></h3>

            <button type="submit" class="btn btn-primary mt-3">Confirmar Reserva</button>
        </form>
    </div>

    <script>
        const precoPorHoraEl =  document.getElementById('preco-hora');
        const horarioInicioEl = document.getElementById('horario_inicio');
        const horarioTerminoEl = document.getElementById('horario_termino');
        const valorTotalEl = document.getElementById('valor-total');

        function CalcularValorTotal() {
            const inicio = horarioInicioEl.value;
            const termino = horarioTerminoEl.value;
            const precoHora = parseFloat(precoPorHoraEl.textContent);
            
            if (!inicio || !termino) {
                valorTotalEl.textContent = '0.00';
                return;
        }

        const dataInicio = new Date('1970-01-01T' + inicio + ':00');
        const dataTermino = new Date('1970-01-01T' + termino + ':00');

        if (dataTermino <= dataInicio) {
            valorTotalEl.textContent = '0.00';
            return;
        }

        const diffMs = dataTermino - dataInicio;
            
            const diffHoras = diffMs / (1000 * 60 * 60);
            const total = diffHoras * precoHora;
            
            valorTotalEl.textContent = total.toFixed(2);
        }

        horarioInicioEl.addEventListener('input', CalcularValorTotal);
        horarioTerminoEl.addEventListener('input', CalcularValorTotal);

    </script>

</body>
</html>